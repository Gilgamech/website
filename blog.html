<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> 
		<link rel="shortcut icon" href="https://www.gilgamech.com/images/favicon.ico" type="image/x-icon"/>
		<meta name="viewport" content="width=device-width","initial-scale=1">
<meta property="og:title" content="Gilgamech's blogging mathematically again." />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.Gilgamech.com/blog.html" />
<meta property="og:description" content="Creating art from math and philosophy from technology. Have a look at the world from a unique point of view." />
<meta property="og:image" content="https://www.gilgamech.com/images/BigG.jpg" />
<meta name="description" content="Creating art from math and philosophy from technology. Have a look at the world from a unique point of view.">
<meta name="keywords" content="blog">
<meta name="author" content="Stephen Gillie">
		<title>Gilgamech Technologies</title>
		<script src="https://www.Sparational.com/Sparational.js"></script>
		<script src="https://www.Gilgamech.com/js/sitelets.js"></script>
		<script src="https://www.Gilgamech.com/js/cryptography.js"></script>
		<link href="https://www.Gilgamech.com/css/normalize.css" rel="stylesheet" type="text/css">
		<link href="https://www.Gilgamech.com/css/Gilgamech.css" rel="stylesheet" type="text/css">
	</head>
	<body>
		<div id="titleParent" class="titleContainer">
			<a class="pageTitle " href="/">Gilgamech Technologies</a>
		</div>
		<div id="headWrapper">
<script type="application/javascript"> 
const colors = ["#E50000", //red"#FF8D00",//orange "#FFFF00", //yellow"#028121",//green "#004CFF",//indigo "#760088",//purple "#FFFFFF",//white"#FFAFC7",//pink"#73D7EE",//teal"#000000"];//black

window.addEventListener("mousedown", (e) => {
	const color = colors.shift();
	var foreground = "#000000"
if (parseInt(color.substr(1,2), 16)+parseInt(color.substr(3,2), 16)+parseInt(color.substr(5,2), 16) < 500){
	foreground = "#FFFFFF"
}

 document.documentElement.style.setProperty("--highlight-color", color);
 document.documentElement.style.setProperty("--foreground-color", foreground);
 colors.push(color);
});
</script>
<style type="text/css"> 
body {
}
.floatingBubble {
 display: inline-block;
 max-width: 98%;
}

.validInput {
	background-color:#d9ead3;
}

.saltine .house {
	text-align:center;
	vertical-align:center;
	padding:2px 3px 2px 3px;
}.saltine .house a {
	color: inherit;
} .s0{
	background-color:#ffd966;
}.s1{
	background-color:#ffe599;
} .s2{
	background-color:#fff2cc;
} .s3{
	background-color:#ffff00;
} .s4{
	background-color:#ff9900;
} .s5{
	background-color:#c9daf8;
} .s6{
	background-color:#f1c232;
} .s7{
} .tableYes{
	background-color:#D9EAD3;
} .tableNo{
	background-color:#F4CCCC;
} .tableMaybe{
	background-color:#FCE5CD;
}

.THeader {
	width:52px;
}
.TRow {
	height: 45px;
	line-height: 45px;
}

:root {
 --highlight-color: null;
 --foreground-color: null;
}

::selection {
 background: var(--highlight-color);
 color: var(--foreground-color);
}

</style>
		</div>
		<div id="navContainer">
			<nav>
                <ul>
                    <li><a>Blog ▼</a><ul>
                        <li><a href="/blog.html">Blog</a></li>
					</ul></li>
                    <li><a href="/history.html">World History</a></li>
                    <li><a>Stuff ▼</a><ul>
                        <li><a href="/Gillogisms.html">Gillogisms</a></li>
                    </ul></li>
                    <li><a href="/contact.html">Contact</a></li>
				</ul>
            </nav>
			</div><script>rebuildElement("navContainer");buildMenuPage("navContainer")</script>
		<div id="content">
			<div class="textBubbleBG"><h4>From the <a href="https://www.youtube.com/watch?v=CNUTlKqSO-I">sublime</a> to the <a href="https://www.youtube.com/watch?v=zy9FkAXMBfk">ridiculous</a>.</h4>
			</div><br><br>
			<div id="0206Bubble" class="textBubbleBG">
			<h1 id="0206Bubble"><a href="#02062023">02/06/2023</a> - Neural Networks - Part 3: Tying together a small net.</h1>
			</div>
<script>
addElement("0206Bubble","What is a neural network? Several neurons connected output to inputs. Building off Part 1, what is a neuron? Weighted inputs (synapses) that sum to an activation value, which modify an output if the activation value is greater than an threshold value.","","p")
addElement("0206Bubble","In a neural network, neurons are stratified into layers:","","p")
var list0206 = addElement("0206Bubble","","","ul")
addElement(list0206,"In the input layer, each input neuron needs one synapse per input. More input neurons will give more input granularity.","","li")
addElement(list0206,"In the middle and output layers, each neuron needs one synapse foreach neuron of the layer above.","","li")
addElement(list0206,"More middle neurons, and more layers will again give more granularity.","","li")
addElement(list0206,"In the output layer, one neuron is needed foreach output value.","","li")
addElement("0206Bubble","Here is the Part 1 neuron condensed into a row, and copied. The mid layer synapses are fed from the input layer, and the output layer's synapses are fed from the mid layer. This network is too small to really be useful, but it gives a functional concept of what larger models are doing.","","p")


//Input array
//weight array
//

addElement("0206Bubble","Inputs","","span")
var inputA_0206 = addElement("0206Bubble","1","","input","","","propagateValues();")
var inputB_0206 = addElement("0206Bubble","0","","input","","","propagateValues();")
mdArrayToTable("0206Bubble","table",[["Title","Synapses","Weights","Threshold","Output"]])
var tbody = returnTablePart("table","TBODY").id

addElement("0206Bubble","There's one more part omitted from Part 1 - the memory and weight update. These are a function that look at the output, and the history, and determine how to modify the weights of each synapse. If increasing the weight increases progress towards the desired goal (aka good) the weight will continue getting increased. But if not, the weight will become decreased.","","p")


//addElement("elementParent","innerText","elementClass","elementType","elementStyle","href","onChange","onClick","contentEditable","attributeType","attributeAction","elementId")

function addNeuronRow(rowName) {
	var neuronRow = addElement(tbody,"","","tr")
	addElement(neuronRow,rowName,"","th")
	addElement(addElement(neuronRow,"","","td"),"[0,0]","","input","","","updateRow('"+rowName+"');propagateValues();","","","","",rowName+"inputs")
	addElement(addElement(neuronRow,"","","td"),"[0.6,0.6]","","input","","","updateRow('"+rowName+"');propagateValues();","","","","",rowName+"weights")
	addElement(addElement(neuronRow,"","","td"),"1","","input","","","updateRow('"+rowName+"');propagateValues();","","","","",rowName+"threshold")
	addElement(addElement(neuronRow,"","","td"),"","","","","","","","","","",rowName+"output")
	updateRow(rowName);
}
function updateRow(rowName){
	writeElement(rowName+"output",doNeuron(readElement(rowName+"inputs"),readElement(rowName+"weights"),readElement(rowName+"threshold")));
}

function propagateValues() {
	writeElement("InputAinputs","["+readElement(inputA_0206)+","+readElement(inputB_0206)+"]")
	updateRow("InputA")
	writeElement("InputBinputs","["+readElement(inputA_0206)+","+readElement(inputB_0206)+"]")
	updateRow("InputB")

	writeElement("MidAinputs","["+readElement('InputAoutput')+","+readElement('InputBoutput')+"]")
	updateRow("MidA")
	writeElement("MidBinputs","["+readElement('InputAoutput')+","+readElement('InputBoutput')+"]")
	updateRow("MidB")

	writeElement("OutAinputs","["+readElement('MidAoutput')+","+readElement('MidBoutput')+"]")
	updateRow("OutA")
	writeElement("OutBinputs","["+readElement('MidAoutput')+","+readElement('MidBoutput')+"]")
	updateRow("OutB")
}

addNeuronRow("InputA")
addNeuronRow("InputB")
addNeuronRow("MidA")
addNeuronRow("MidB")
addNeuronRow("OutA")
addNeuronRow("OutB")

addElement("content","","","br")
addElement("content","","","br")

function doNeuron(inputArray,weightArray,threshold){
	var accumulate = 0;
	inputArray = eval(inputArray)
	weightArray = eval(weightArray)
	threshold = eval(threshold)
	for (var i = 0;i<inputArray.length;i++) {
		accumulate += inputArray[i]*weightArray[i]
	}
	if (accumulate >= threshold) {
		return accumulate//1
	} else {
		return 0
	}
	
}

propagateValues();
</script>
					
					
			<div id="0205Bubble" class="textBubbleBG">
			<h1 id="0205Bubble"><a href="#02052023">02/05/2023</a> - Neural Networks - Part 2: Hardware is king.</h1>
			</div>
<script>
addElement("0205Bubble","What is a neural network?","","h2")
addElement("0205Bubble","Right now, neural networks are arrays stored and computed on massive GPUs in cloud servers.","","p")

addElement("0205Bubble","How much would one server cost?","","h2")
addElement("0205Bubble","Some numbers from Tom Goldstein (and Mayank Mishra) on Twitter (and a little value-add). Tom estimates that 'A100 GPU costs about $3/hr to rent on Azure.'","","p")
mdArrayToTable("0205Bubble","0205Table2",[
["Model", "#A100s", "HW/mo", "OS/mo", "Total/mo", "Total/day", "Total/hour", "Total/hour/A100"],
["Standard_ND96amsr_A100_v4",8, 10525.72, 3223.68],
["1/8 server (represents 1x A100)",1, 1315.715, 402.96]
])
columnMath("0205Table2",2,"0205Table2",3,0,"0205Table2",4,"add",2,"") //Total/mo
columnMath("0205Table2",4,"",30,0,"0205Table2",5,"divide",2,"") //Total/day
columnMath("0205Table2",5,"",24,0,"0205Table2",6,"divide",2,"") //Total/hour
columnMath("0205Table2",6,"0205Table2",1,0,"0205Table2",7,"divide",2,"") //Total/hour/A100

addElement("0205Bubble","To verify, we can find the specific model of server that comes with 8x A100 GPUs: 'Standard_ND96amsr_A100_v4'. This model isn't available in all regions, but it *is* available in the East US region. With a 3 year reservation, the Azure Pricing Calculator says this class of server costs $13,749.40 per month, which is close. This is just for the server, and not for bandwidth.","","p")


addElement("0205Bubble","How many queries can one server answer?","","h2")
mdArrayToTable("0205Bubble","0205Table1",[
["Model", "Parameters", "ms", "sec/ms", "#A100s","Param/ms","Param/ms/#A100s","words/sec","words/day","queries/day"],
["3 billion", "3 billion", 6, 1000, 1],
["ChatGPT 1GPU", "175 billion", 350, 1000, 1],
["ChatGPT", "175 billion", 50, 1000, 8],
["BLOOM 176B", "176 billion", 45, 1000, 8]
])
columnMath("0205Table1",1,"0205Table1",2,0,"0205Table1",5,"divide",2,"true") //Param/ms
columnMath("0205Table1",5,"0205Table1",4,0,"0205Table1",6,"divide",2,"true") //Param/ms/#A100s
columnMath("0205Table1",3,"0205Table1",2,0,"0205Table1",7,"divide",2,"true") //words/sec
columnMath("0205Table1",7,"",86400,0,"0205Table1",8,"multiply",2,"true") //words/day
columnMath("0205Table1",8,"",30,0,"0205Table1",9,"divide",2,"true") //queries/day
addElement("0205Bubble","When compared in terms of parameters per millisecond per A100, these estimations become somewhat consistent. Each GPU can process about 400-500 million parameters per millisecond, and this rate lets the 175-176 billion parameter models produce about 20 words per second. At 86400 seconds/day, 20 words/sec gives 1.73 million words/day. At 30 words/query, this gives 57,670 queries/day per server. ","","p")

addElement("0205Bubble","How much would one day cost?","","h2")
addElement("0205Bubble","Tom estimates (and I agree) that 1 million users could easily average 10 queries per day, so 10 million queries/day isn't unreasonable. To support 10 million queries/day, 174 instances are needed. Tom estimates this costs $100k/day or $3 million/month.","","p")

mdArrayToTable("0205Bubble","0205Table3",[
["ND96amsr", "1 server", "174 servers"],
["Month","13.75k"],
["Year","165k"],
])
columnMath("0205Table3",1,"",174,0,"0205Table3",2,"multiply",2,"") //174 servers
addElement("0205Bubble","So again, this is a fairly accurate estimate.","","p")

addLinkToWord("0205Bubble","02/05/2023","#02052023")
addLinkToWord("0205Bubble","Tom Goldstein","https://twitter.com/tomgoldsteincs/status/1600296981955050694")
addLinkToWord("0205Bubble","Azure pricing calculator","https://azure.microsoft.com/en-us/pricing/calculator/")
addLinkToWord("0205Bubble","Mayank Mishra","https://huggingface.co/blog/bloom-inference-pytorch-scripts")
addLinkToWord("0205Bubble","specific model of server","https://azureprice.net/vm/Standard_ND96amsr_A100_v4")
addElement("content","","","br")
addElement("content","","","br")
</script>
		   
			<div id="0204Bubble" class="textBubbleBG">
			<h1 id="0204Bubble"><a href="#02042023">02/04/2023</a> - Neural Networks - Part 1: Neuron.</h1>
			</div>
<script>
addElement("0204Bubble","What is a neural network? Here is a neuron from a miniature 'neural network in a spreadsheet' upgraded to a JS-driven table. It came from a Medium article by MoralRobots that has since been deleted by its author.","","p")
addElement("0204Bubble","Here you can control both inputs, the synapse weight, and the threshold.","","p")

var table = addElement("0204Bubble","","","table")
var thead = addElement(table,"","","thead")
var theadrow = addElement(thead,"","","tr")
addElement(theadrow,"Title","","th")
addElement(theadrow,"A","","th")
addElement(theadrow,"B","","th")
addElement(theadrow,"Synapse Weight","","th")
var tbody = addElement(table,"","","tbody")

var Inputsrow = addElement(tbody,"","","tr")
addElement(Inputsrow,"Inputs","","th")
var inputA = addElement(addElement(Inputsrow,"","","td"),"1","","input","","","runSynapses()","","","type","number")
var inputB = addElement(addElement(Inputsrow,"","","td"),"0","","input","","","runSynapses()","","","type","number")

var Synapsesrow = addElement(tbody,"","","tr")
addElement(Synapsesrow,"Synapses","","th")
var synapseA = addElement(Synapsesrow,"","","td")
var synapseB = addElement(Synapsesrow,"","","td")
var synapseWeight = addElement(addElement(Synapsesrow,"","","td"),"0.6","","input","","","runSynapses()","","","type","number")

var Weightedrow = addElement(tbody,"","","tr")
addElement(Weightedrow,"Weighted Output","","th")
var outputA = addElement(Weightedrow,"","","td")
var outputB = addElement(Weightedrow,"","","td")

var Activationrow = addElement(tbody,"","","tr")
addElement(Activationrow,"Activation","","th")
var activation = addElement(Activationrow,"","","td")

var Thresholdrow = addElement(tbody,"","","tr")
addElement(Thresholdrow,"Threshold","","th")
var threshold = addElement(addElement(Thresholdrow,"","","td"),"1","","input","","","runSynapses()","","","type","number")

var Outputrow = addElement(tbody,"","","tr")
addElement(Outputrow,"Output","","th")
var outputFinal = addElement(Outputrow,"","","td")
		   
addElement("0204Bubble","The article offered 2 simple modes of operation: ","","p")
var list0204 = addElement("0204Bubble","","","ul")
addElement(list0204,"Synapse weight set to 1 - OR circuit","","li")
addElement(list0204,"Synapse weight set to 0.6 - AND circuit","","li")
addElement("0204Bubble","Setting the weight to 1 makes this circuit into an OR circuit, where setting either input to 1 will set the output to 1. Only when both are set to 0 will the output be 0, so it's not an XOR. And setting the weight to 0.6 turns this into an AND circuit, where both inputs must be 1 to turn the output to 1.","","p")
addElement("0204Bubble","When you start playing with it, you may start using decimal numbers to get more fine-tuned results. This sorta works in simulation, but not with individual bits - these must be 0s or 1s. But there is a quantum solution for this as well. Readers of my Gillogisms know where this is going.","","p")


addElement("content","","","br")
addElement("content","","","br")

function runSynapses(){
	writeElement(synapseA,(readElement(synapseWeight)*1))
	writeElement(synapseB,(readElement(synapseWeight)*1))

	writeElement(outputA,readElement(inputA)*readElement(synapseA))
	writeElement(outputB,readElement(inputB)*readElement(synapseB))
	
	writeElement(activation,(readElement(outputA)*1)+(readElement(outputB)*1))
	if (readElement(activation) >= readElement(threshold)) {
		writeElement(outputFinal,1)
	} else {
		writeElement(outputFinal,0)
	}
	
}

runSynapses();

</script>
		   
		</div><!-- End Content-->
		<div id="footWrapper">
			<div class="container-fluid">
			</div>
			<div id="spacerName">
				<br>
				<br>
			</div>
			<div id="errDiv" class="row img-rounded">
			</div>
			<div id="footerStatic" class="navbar-static-bottom" style="text-align: center;">
				<p class="copyright">© 2013-2023 Gilgamech Technologies - Powered by <a href="https://www.Sparational.com/">Sparational.js</a>.</p>
			</div>
		</div>
	</body>
</html>